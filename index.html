<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Persistent Browser Game</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f0f0f0; }
        #game-container { display: flex; }
        #sidebar { width: 250px; padding: 10px; background-color: #333; color: #fff; }
        #main-game { flex-grow: 1; padding: 10px; }
        .button { padding: 10px; margin: 5px; cursor: pointer; }
        .button:hover { background-color: #555; }
        .craft-item { margin: 5px; padding: 8px; background-color: #222; color: #fff; border: 1px solid #444; }
        .craft-item:hover { background-color: #444; }
        .rarity-common { color: gray; }
        .rarity-rare { color: blue; }
        .rarity-epic { color: purple; }
        #stats { margin-top: 20px; }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="sidebar">
            <h2>Game Stats</h2>
            <div id="stats">
                <p>HP: <span id="player-hp">100</span></p>
                <p>ATK: <span id="player-atk">10</span></p>
                <p>DEF: <span id="player-def">5</span></p>
                <p>Crit Chance: <span id="player-crit">5%</span></p>
                <hr>
                <h3>Inventory</h3>
                <ul id="inventory-list"></ul>
                <hr>
                <h3>Crafting</h3>
                <div id="crafting-area">
                    <div class="craft-item" data-item="wooden-sword" onclick="craftItem('wooden-sword')">Craft Wooden Sword</div>
                    <div class="craft-item" data-item="iron-sword" onclick="craftItem('iron-sword')">Craft Iron Sword</div>
                </div>
                <hr>
                <h3>Daily Quests</h3>
                <div id="daily-quests">
                    <button onclick="startQuest()">Start Daily Quest</button>
                    <div id="quests-status"></div>
                </div>
            </div>
        </div>
        <div id="main-game">
            <h1>Battle Zone</h1>
            <button class="button" onclick="startBattle()">Start Battle</button>
            <div id="battle-log"></div>
        </div>
    </div>

    <script>
        let player = {
            hp: 100,
            atk: 10,
            def: 5,
            critChance: 5,
            inventory: [],
            questsCompleted: 0,
            lastQuestTime: Date.now()
        };

        const resources = {
            wood: 0,
            iron: 0
        };

        const gearRarity = {
            common: 'rarity-common',
            rare: 'rarity-rare',
            epic: 'rarity-epic'
        };

        // Check if progress exists in localStorage
        if(localStorage.getItem('playerProgress')) {
            player = JSON.parse(localStorage.getItem('playerProgress'));
        }

        // Update player stats on screen
        function updateStats() {
            document.getElementById('player-hp').innerText = player.hp;
            document.getElementById('player-atk').innerText = player.atk;
            document.getElementById('player-def').innerText = player.def;
            document.getElementById('player-crit').innerText = player.critChance + '%';
            updateInventory();
        }

        // Update inventory UI
        function updateInventory() {
            const inventoryList = document.getElementById('inventory-list');
            inventoryList.innerHTML = '';
            player.inventory.forEach(item => {
                let li = document.createElement('li');
                li.innerText = item.name;
                li.classList.add(item.rarity);
                inventoryList.appendChild(li);
            });
        }

        // Crafting system
        function craftItem(itemName) {
            if(itemName === 'wooden-sword' && resources.wood >= 2) {
                resources.wood -= 2;
                const newItem = { name: 'Wooden Sword', rarity: gearRarity.common };
                player.inventory.push(newItem);
            } else if(itemName === 'iron-sword' && resources.iron >= 3) {
                resources.iron -= 3;
                const newItem = { name: 'Iron Sword', rarity: gearRarity.rare };
                player.inventory.push(newItem);
            }
            updateStats();
        }

        // Simulate a daily quest
        function startQuest() {
            const currentTime = Date.now();
            const timeDifference = currentTime - player.lastQuestTime;
            const questCooldown = 24 * 60 * 60 * 1000; // 24 hours in milliseconds

            if(timeDifference < questCooldown) {
                alert('You must wait for your next daily quest!');
                return;
            }

            player.lastQuestTime = currentTime;
            player.questsCompleted += 1;
            localStorage.setItem('playerProgress', JSON.stringify(player));

            // Reward system: Based on quests completed, increase stats.
            player.atk += 5;
            player.def += 2;
            updateStats();

            document.getElementById('quests-status').innerText = `Quest completed! You have completed ${player.questsCompleted} quests.`;
            localStorage.setItem('playerProgress', JSON.stringify(player));
        }

        // Simulate a battle
        function startBattle() {
            let battleLog = document.getElementById('battle-log');
            const enemyHp = Math.floor(Math.random() * 50) + 50;
            let damage = player.atk - Math.floor(Math.random() * player.def);
            if(Math.random() * 100 < player.critChance) {
                damage *= 2;
                battleLog.innerHTML += `<p>Critical hit! You dealt ${damage} damage to the enemy!</p>`;
            } else {
                battleLog.innerHTML += `<p>You dealt ${damage} damage to the enemy!</p>`;
            }

            if(enemyHp <= 0) {
                battleLog.innerHTML += `<p>You won the battle!</p>`;
            } else {
                battleLog.innerHTML += `<p>The enemy's remaining health is ${enemyHp - damage}</p>`;
            }
        }

        // Initialize game
        updateStats();
    </script>
</body>
</html>
